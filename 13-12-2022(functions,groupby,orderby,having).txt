--------------------multi statement table valued function---------------
--creating function with select statement
create function multi_statement_pass_fail(@num int)
returns @table table(sttud_Roll_NO int,subject1 int,subject2 int,subject3 int,total int)
as
begin
insert into @table
 select stud_Roll_NO,subject1,subject2,subject3,total from Education_detail where total>=@num
 return
end

--altering function with update statement
alter function multi_statement_pass_fail(@num int)
returns @table table(sttud_Roll_NO int,subject1 int,subject2 int,subject3 int,total int)
as
begin
insert into @table
 select stud_Roll_NO,subject1,subject2,subject3,total from Education_detail where total>=@num
 update @table set sttud_Roll_NO=25 where sttud_Roll_NO=13
 return
end
select * from multi_statement_pass_fail(250)

--join
select Students.stud_Name,Education_detail.stud_Roll_NO,Education_detail.subject1,Education_detail.subject2,
Education_detail.subject3,Education_detail.total from dbo.multi_statement_pass_fail(200) 
 inner join Students  on Students.stud_Roll_NO=Education_detail.stud_Roll_NO

drop function multi_statement_pass_fail

---order by
select * from Education_detail order by total 
select * from Education_detail order by total desc
select * from Education_detail order by total,subject1 desc
select * from Education_detail  where total>=280 order by total
select * from Education_detail   order by total
select Students.stud_Name,Education_detail.stud_Roll_NO,Education_detail.total from Education_detail
inner join students on Students.stud_Roll_NO=Education_detail.stud_Roll_NO order by stud_Name,total

---group by
select count(stud_roll_no ),stud_Name from Students group by stud_Name
select max(total),average from Education_detail group by average
select count(total),average from Education_detail group by average
select sum(total),subject1 from Education_detail group by subject1
select total from Education_detail group by total where total=282
select Students.stud_Name,Education_detail.total from Education_detail
inner join students on Students.stud_Roll_NO=Education_detail.stud_Roll_NO group by stud_Name,total
select Students.stud_Name from Education_detail
inner join students on Students.stud_Roll_NO=Education_detail.stud_Roll_NO group by stud_Name order by total

---having clause
select total from Education_detail group by total having total>=282
select total,stud_Roll_NO from Education_detail group by total,stud_Roll_NO having total>=282
select total,stud_Roll_NO from Education_detail group by total,stud_Roll_NO having total>=282 order by count(stud_roll_no)
select total,stud_Roll_NO from Education_detail group by total,stud_Roll_NO having total>=282 order by stud_roll_no
select total from Education_detail group by total having total>=282 order by count(stud_roll_no)
select total,stud_Roll_NO from Education_detail group by total,stud_Roll_NO having total>=282 order by count(stud_roll_no)
select Students.stud_Name,Education_detail.total from Education_detail
inner join students on Students.stud_Roll_NO=Education_detail.stud_Roll_NO group by stud_Name,total having total>200 order by total

/*
multi statement table valued function with joins and group by clause

create function multistatement_pass_fail(@num int)
returns @table table(stud_Name nvarchar,total int)
as
begin
insert into @table
 select Students.stud_Name,count(total) from Education_detail
inner join students on Students.stud_Roll_NO=Education_detail.stud_Roll_NO group by stud_Name,total 
 return
end
select * from multistatement_pass_fail(2)
*/
